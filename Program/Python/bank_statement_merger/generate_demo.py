"""
生成Demo测试文件脚本
运行后会在 demo 文件夹生成 xlsx、xls、csv 三种格式文件
"""

import pandas as pd
from pathlib import Path

demo_path = Path(__file__).parent / "demo"
demo_path.mkdir(exist_ok=True)

# 工商银行示例数据 (xlsx格式)
icbc_data = {
    "交易时间": ["2024-01-01 10:30:00", "2024-01-02 14:20:00", "2024-01-03 09:15:00"],
    "帐户": ["6222021234567890", "6222021234567890", "6222021234567890"],
    "对方账户": ["6228481234567890", "6225881234567890", "6217001234567890"],
    "交易金额": [1000.00, -500.50, 2000.00],
    "摘要": ["工资", "转账", "报销"],
    "余额": [10000.00, 9499.50, 11499.50]
}

# 建设银行示例数据 (xls格式)
ccb_data = {
    "时间": ["2024-01-01", "2024-01-02", "2024-01-03"],
    "帐号": ["6217001234567890", "6217001234567890", "6217001234567890"],
    "对方帐号": ["6222021234567890", "6228481234567890", "6225881234567890"],
    "金额": [500.00, -200.00, 1500.00],
    "备注信息": ["收款", "消费", "转入"],
    "当前余额": [5000.00, 4800.00, 6300.00]
}

# 招商银行示例数据 (csv格式)
cmb_data = {
    "交易日": ["2024-01-01", "2024-01-02", "2024-01-03"],
    "账户号": ["6225881234567890", "6225881234567890", "6225881234567890"],
    "他方账号": ["6222021234567890", "6217001234567890", "6228481234567890"],
    "交易额": [800.00, -300.00, 1200.00],
    "用途": ["收入", "支出", "转账"],
    "账面余额": [8000.00, 7700.00, 8900.00]
}

# 农业银行示例数据 (xlsx格式)
abc_data = {
    "交易时间": ["2024-01-04 11:00:00", "2024-01-05 15:30:00"],
    "本方账号": ["6228481234567890", "6228481234567890"],
    "对方账号": ["6222021234567890", "6217001234567890"],
    "交易金额": [3000.00, -1000.00],
    "摘要": ["转入", "消费"],
    "账户余额": [15000.00, 14000.00]
}

# 中国银行示例数据 (xls格式)
boc_data = {
    "交易日期": ["2024-01-06", "2024-01-07"],
    "账户": ["6217851234567890", "6217851234567890"],
    "对方账户": ["6222021234567890", "6225881234567890"],
    "交易金额": [2500.00, -800.00],
    "交易摘要": ["工资", "转账"],
    "余额": [20000.00, 19200.00]
}

# 生成 xlsx 格式
pd.DataFrame(icbc_data).to_excel(demo_path / "工商银行流水.xlsx", index=False, engine="openpyxl")
print("生成: 工商银行流水.xlsx")

pd.DataFrame(abc_data).to_excel(demo_path / "农业银行流水.xlsx", index=False, engine="openpyxl")
print("生成: 农业银行流水.xlsx")

# 生成 xls 格式 (需要 xlwt)
try:
    pd.DataFrame(ccb_data).to_excel(demo_path / "建设银行流水.xls", index=False, engine="xlwt")
    print("生成: 建设银行流水.xls")
except Exception:
    pd.DataFrame(ccb_data).to_excel(demo_path / "建设银行流水.xlsx", index=False, engine="openpyxl")
    print("生成: 建设银行流水.xlsx (xlwt未安装，使用xlsx格式)")

try:
    pd.DataFrame(boc_data).to_excel(demo_path / "中国银行流水.xls", index=False, engine="xlwt")
    print("生成: 中国银行流水.xls")
except Exception:
    pd.DataFrame(boc_data).to_excel(demo_path / "中国银行流水.xlsx", index=False, engine="openpyxl")
    print("生成: 中国银行流水.xlsx (xlwt未安装，使用xlsx格式)")

# 生成 csv 格式
pd.DataFrame(cmb_data).to_csv(demo_path / "招商银行流水.csv", index=False, encoding="utf-8-sig")
print("生成: 招商银行流水.csv")

print("\nDemo文件已生成到 demo 文件夹")
