# é¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜

æœ¬æ–‡æ¡£è¯´æ˜C++ Gatewayé¡¹ç›®çš„ç›®å½•ç»“æ„å’Œæ–‡ä»¶ç»„ç»‡ã€‚

## ç›®å½•ç»“æ„

```
cpp-gateway/
â”‚
â”œâ”€â”€ ğŸ“ config/              # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ config.json         # ç½‘å…³é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“ include/             # C++å¤´æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ types.hpp           # åŸºç¡€ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ http_types.hpp      # HTTPæ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ config_types.hpp    # é…ç½®æ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ http_parser.hpp     # HTTPè§£æå™¨
â”‚   â”œâ”€â”€ config_manager.hpp  # é…ç½®ç®¡ç†å™¨
â”‚   â”œâ”€â”€ logger.hpp          # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ request_router.hpp  # è¯·æ±‚è·¯ç”±å™¨
â”‚   â”œâ”€â”€ load_balancer.hpp   # è´Ÿè½½å‡è¡¡å™¨
â”‚   â”œâ”€â”€ http_client.hpp     # HTTPå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ http_server.hpp     # HTTPæœåŠ¡å™¨
â”‚   â””â”€â”€ gateway.hpp         # ç½‘å…³æ ¸å¿ƒ
â”‚
â”œâ”€â”€ ğŸ“ src/                 # C++æºæ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ main.cpp            # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ http_parser.cpp     # HTTPè§£æå®ç°
â”‚   â”œâ”€â”€ config_manager.cpp  # é…ç½®ç®¡ç†å®ç°
â”‚   â”œâ”€â”€ logger.cpp          # æ—¥å¿—ç³»ç»Ÿå®ç°
â”‚   â”œâ”€â”€ request_router.cpp  # è·¯ç”±åŒ¹é…å®ç°
â”‚   â”œâ”€â”€ load_balancer.cpp   # è´Ÿè½½å‡è¡¡å®ç°
â”‚   â”œâ”€â”€ http_client.cpp     # HTTPå®¢æˆ·ç«¯å®ç°
â”‚   â”œâ”€â”€ http_server.cpp     # HTTPæœåŠ¡å™¨å®ç°
â”‚   â””â”€â”€ gateway.cpp         # ç½‘å…³æ ¸å¿ƒå®ç°
â”‚
â”œâ”€â”€ ğŸ“ build/               # æ„å»ºè„šæœ¬å’Œä¸´æ—¶æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ Makefile            # Makeæ„å»ºé…ç½®
â”‚   â”œâ”€â”€ CMakeLists.txt      # CMakeæ„å»ºé…ç½®
â”‚   â”œâ”€â”€ build.sh            # Linux/macOSæ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build.bat           # Windowsæ„å»ºè„šæœ¬
â”‚   â””â”€â”€ obj/                # ç¼–è¯‘ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶(.o)
â”‚
â”œâ”€â”€ ğŸ“ output/              # å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ gateway             # ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“ tests/               # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ EXAMPLES.md         # ä½¿ç”¨ç¤ºä¾‹æ–‡æ¡£
â”‚   â”œâ”€â”€ test_backend.py     # Pythonæµ‹è¯•åç«¯æœåŠ¡å™¨
â”‚   â””â”€â”€ test_gateway.sh     # Shellæµ‹è¯•è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“ third_party/         # ç¬¬ä¸‰æ–¹ä¾èµ–åº“ç›®å½•
â”‚   â””â”€â”€ README.md           # ä¾èµ–å®‰è£…è¯´æ˜
â”‚
â”œâ”€â”€ ğŸ“ .kiro/               # Kiro IDEè§„æ ¼æ–‡æ¡£
â”‚   â””â”€â”€ specs/
â”‚       â””â”€â”€ cpp-gateway/
â”‚           â”œâ”€â”€ requirements.md  # éœ€æ±‚æ–‡æ¡£
â”‚           â”œâ”€â”€ design.md        # è®¾è®¡æ–‡æ¡£
â”‚           â””â”€â”€ tasks.md         # ä»»åŠ¡åˆ—è¡¨
â”‚
â”œâ”€â”€ ğŸ“„ make.sh              # å¿«æ·ç¼–è¯‘è„šæœ¬ï¼ˆè°ƒç”¨build/Makefileï¼‰
â”œâ”€â”€ ğŸ“„ .gitignore           # Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”‚
â”œâ”€â”€ ğŸ“„ README.md            # é¡¹ç›®ä¸»æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ QUICKSTART.md        # å¿«é€Ÿå¯åŠ¨æŒ‡å—
â”œâ”€â”€ ğŸ“„ PROJECT_STATUS.md    # é¡¹ç›®çŠ¶æ€æ€»ç»“
â””â”€â”€ ğŸ“„ STRUCTURE.md         # æœ¬æ–‡ä»¶

```

## ç›®å½•è¯´æ˜

### æºä»£ç ç›®å½•

| ç›®å½• | è¯´æ˜ | æ–‡ä»¶æ•°é‡ |
|------|------|---------|
| `include/` | C++å¤´æ–‡ä»¶ï¼Œå®šä¹‰ç±»å’Œæ¥å£ | 11ä¸ª |
| `src/` | C++æºæ–‡ä»¶ï¼Œå®ç°å…·ä½“åŠŸèƒ½ | 9ä¸ª |

### é…ç½®å’Œæ•°æ®ç›®å½•

| ç›®å½• | è¯´æ˜ |
|------|------|
| `config/` | å­˜æ”¾ç½‘å…³é…ç½®æ–‡ä»¶ |

### æ„å»ºç›¸å…³ç›®å½•

| ç›®å½• | è¯´æ˜ | æ˜¯å¦æäº¤åˆ°Git |
|------|------|--------------|
| `build/` | å­˜æ”¾ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ–‡ä»¶ | âŒ ä¸æäº¤ |
| `output/` | å­˜æ”¾æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ | âŒ ä¸æäº¤ |

### æµ‹è¯•ç›®å½•

| ç›®å½• | è¯´æ˜ |
|------|------|
| `tests/` | æµ‹è¯•è„šæœ¬å’Œç¤ºä¾‹æ–‡æ¡£ |

### ä¾èµ–ç›®å½•

| ç›®å½• | è¯´æ˜ |
|------|------|
| `third_party/` | ç¬¬ä¸‰æ–¹åº“ï¼ˆéœ€è¦æ‰‹åŠ¨ä¸‹è½½ï¼‰ |

## æ–‡ä»¶è¯´æ˜

### æ„å»ºæ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” | å¹³å° |
|------|------|------|
| `build/CMakeLists.txt` | CMakeæ„å»ºé…ç½® | è·¨å¹³å° |
| `build/Makefile` | Makeæ„å»ºé…ç½® | Linux/macOS |
| `build/build.sh` | CMakeè‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ | Linux/macOS |
| `build/build.bat` | CMakeè‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ | Windows |
| `make.sh` | å¿«æ·ç¼–è¯‘è„šæœ¬ | Linux/macOS |

### æ–‡æ¡£æ–‡ä»¶

| æ–‡ä»¶ | å†…å®¹ |
|------|------|
| `README.md` | é¡¹ç›®ä»‹ç»ã€åŠŸèƒ½ç‰¹æ€§ã€ç¼–è¯‘è¿è¡Œè¯´æ˜ |
| `QUICKSTART.md` | å¿«é€Ÿä¸Šæ‰‹æŒ‡å— |
| `PROJECT_STATUS.md` | é¡¹ç›®å®ŒæˆçŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯ |
| `STRUCTURE.md` | æœ¬æ–‡ä»¶ï¼Œç›®å½•ç»“æ„è¯´æ˜ |
| `tests/EXAMPLES.md` | è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹ |

## ç¼–è¯‘æµç¨‹

### ä½¿ç”¨Makefileï¼ˆæ¨èï¼‰

```bash
# ä»æ ¹ç›®å½•
./make.sh         # ç¼–è¯‘é¡¹ç›®
./make.sh clean   # æ¸…ç†æ„å»ºæ–‡ä»¶

# æˆ–è¿›å…¥buildç›®å½•
cd build
make              # ç¼–è¯‘é¡¹ç›®
make clean        # æ¸…ç†æ„å»ºæ–‡ä»¶
```

**ç¼–è¯‘äº§ç‰©**:
- ç›®æ ‡æ–‡ä»¶: `build/obj/*.o`
- å¯æ‰§è¡Œæ–‡ä»¶: `output/gateway`

### ä½¿ç”¨CMake

```bash
./build/build.sh  # Linux/macOS
build\build.bat   # Windows

# æˆ–æ‰‹åŠ¨
cd build
cmake ..
make
```

**ç¼–è¯‘äº§ç‰©**:
- å¯æ‰§è¡Œæ–‡ä»¶: `output/gateway`

## è¿è¡Œæµç¨‹

1. **ç¼–è¯‘é¡¹ç›®**
   ```bash
   ./make.sh
   # æˆ–: cd build && make
   ```

2. **å¯åŠ¨æµ‹è¯•åç«¯**ï¼ˆå¯é€‰ï¼‰
   ```bash
   python3 tests/test_backend.py 9001 &
   ```

3. **è¿è¡Œç½‘å…³**
   ```bash
   ./output/gateway config/config.json
   ```

4. **æµ‹è¯•ç½‘å…³**
   ```bash
   ./tests/test_gateway.sh
   ```

## æ¸…ç†å‘½ä»¤

```bash
# æ¸…ç†æ‰€æœ‰æ„å»ºäº§ç‰©
./make.sh clean
# æˆ–: cd build && make clean

# æ‰‹åŠ¨æ¸…ç†
rm -rf build/obj/ output/
```

## ç‰ˆæœ¬æ§åˆ¶

### æäº¤åˆ°Gitçš„æ–‡ä»¶

âœ… æºä»£ç  (`src/`, `include/`)
âœ… é…ç½®æ–‡ä»¶ (`config/`)
âœ… æ„å»ºè„šæœ¬ (`build/CMakeLists.txt`, `build/Makefile`, `build/build.sh`, `build/build.bat`, `make.sh`)
âœ… æ–‡æ¡£ (`*.md`)
âœ… æµ‹è¯•è„šæœ¬ (`tests/`)

### ä¸æäº¤åˆ°Gitçš„æ–‡ä»¶

âŒ æ„å»ºä¸´æ—¶æ–‡ä»¶ (`build/obj/`)
âŒ å¯æ‰§è¡Œæ–‡ä»¶ (`output/`)
âŒ æ—¥å¿—æ–‡ä»¶ (`*.log`)
âŒ ç¬¬ä¸‰æ–¹åº“ (`third_party/*/`)ï¼ˆé™¤äº†README.mdï¼‰

## æ·»åŠ æ–°åŠŸèƒ½

### æ·»åŠ æ–°æ¨¡å—

1. åœ¨ `include/` åˆ›å»ºå¤´æ–‡ä»¶ `new_module.hpp`
2. åœ¨ `src/` åˆ›å»ºæºæ–‡ä»¶ `new_module.cpp`
3. æ›´æ–° `build/CMakeLists.txt` å’Œ `build/Makefile` çš„æºæ–‡ä»¶åˆ—è¡¨
4. é‡æ–°ç¼–è¯‘: `./make.sh`

### æ·»åŠ æ–°æµ‹è¯•

1. åœ¨ `tests/` åˆ›å»ºæµ‹è¯•æ–‡ä»¶
2. æ›´æ–° `tests/EXAMPLES.md` æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

## å¸¸è§é—®é¢˜

### Q: ç¼–è¯‘åæ‰¾ä¸åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Ÿ
A: å¯æ‰§è¡Œæ–‡ä»¶åœ¨ `output/gateway`ï¼Œä¸åœ¨æ ¹ç›®å½•ã€‚

### Q: å¦‚ä½•æ¸…ç†æ‰€æœ‰æ„å»ºæ–‡ä»¶ï¼Ÿ
A: è¿è¡Œ `make clean` æˆ–æ‰‹åŠ¨åˆ é™¤ `build/` å’Œ `output/` ç›®å½•ã€‚

### Q: ä¿®æ”¹ä»£ç åå¦‚ä½•é‡æ–°ç¼–è¯‘ï¼Ÿ
A: ç›´æ¥è¿è¡Œ `./make.sh`ï¼ŒMakefileä¼šè‡ªåŠ¨æ£€æµ‹ä¿®æ”¹çš„æ–‡ä»¶ã€‚

### Q: å¦‚ä½•åœ¨ä¸åŒå¹³å°ç¼–è¯‘ï¼Ÿ
A: 
- Linux/macOS: `./make.sh` æˆ– `./build/build.sh`
- Windows: `build\build.bat` æˆ–ä½¿ç”¨CMake

---

**æœ€åæ›´æ–°**: 2024-12-05
